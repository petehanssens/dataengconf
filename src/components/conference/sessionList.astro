---
import {fetchData} from './allData.astro';

const { city} = Astro.props;
const sessionDetails = await fetchData(city.endpoint+'GridSmart')
function timeStampConverter(timestamp: any) {

  try {
    const data = new Date(timestamp).toLocaleTimeString();;
    
    return data;
  } catch (error) {
    console.error("Error fetching data:", error);
    throw error;
  }
}
---

<div class="bg-white-900 py-12 sm:py-18">
    <div class="mx-auto max-w-12xl px-6 text-center lg:px-8">
        <h1 class="text-5xl font-bold text-left">{city.venue}</h1>
        <h1 class="text-2xl text-left">{sessionDetails[0].date?.substring(0,10)}</h1>
        {
            sessionDetails[0].rooms.map((room) => {
                return (
                    
                    <h2 class="text-3xl font-bold py-6 sm:py-9">Room: {room.name}</h2>
                    <ul role="list" class="mx-auto grid max-w-2xl grid-cols-1 gap-6 sm:grid-cols-2 lg:mx-0 md:grid-cols-3 lg:grid-cols-4 lg:max-w-none xl:grid-cols-5 lg:gap-2">
                    {room.sessions.map((session) => {
                        return (
                        <li class="rounded-2xl bg-gray-800 px-2 py-2">
                            <div class="card-body items-center text-center">
                                <div class="badge badge-outline">{session.startsAt}</div> 
                                <h2 class="mt-6 text-lg font-semibold leading-7 tracking-tight text-white">{session.title}</h2>
                                <p class="text-sm leading-6 text-gray-400">{session.speakers.map(function(item) {
                                    return item['name'];
                                })}</p>
                                <div class="card-actions">
                                    <a href={`/session/${session.id}?apiUrl=${city.endpoint+'All'}`} >
                                        <button class="btn btn-primary">Find out more</button>
                                    </a>
                                </div>
                        </div>
                    </li>
                        )
                    
                    })
                    }</ul>
                )
            })
        }
    </div>
</div>